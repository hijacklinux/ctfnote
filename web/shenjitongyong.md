---
layout: default
---
# ![](../img/hj.jpg)代码审计通用思路

1、通读全文代码，从功能函数代码开始阅读，例如include文件夹下的common_fun.php，或者有类似关键字的文件。

2、看配置文件，带有config关键字的文件，找到mysql.class.php文件的connect()函数，查看在数据库连接时是否出现漏洞。

3、继续跟读首页文件,index.php,了解程序运作时调用了哪些函数和文件 以index.php文件作为标线，一层一层去扩展阅读所包含的文件，了解其功能，之后进入其功能文件夹的首页文件，进行扩展阅读。

## ![](../img/github8.png)根据敏感关键字回溯参数传递过程
## ![](../img/github9.png)查找可控变量，正向追踪变量传递过程
## ![](../img/github10.png)寻找敏感功能点，通读功能点代码
文件上传功能：
```
常见漏洞为任意文件上传漏洞及SQL注入漏洞（文件名保存到数据库中，所以就会存在 SQL 注入漏洞）
```
文件管理功能：
```
如果程序将文件名或者文件路径直接在参数中传递，则很有可能会存在任意文件操作的漏洞，比如任意文件读取等，利用的方式是在路径中使用 ../ 或者 ..\ 跳转目录。
还可能存在XSS漏洞，程序会在页面中输出文件名，而通常会疏忽对文件名进行过滤，导致可以在数据库中存入带有尖括号等特殊符号的文件名，最后显示在页面上的时候就会被执行。
```
登录认证功能：
```
目前的认证方式大多是基于 Cookie 和 Session，如果这段 Cookie 信息没有加 salt 一类的东西，就可以导致任意用户登录漏洞。
```

找回密码功能：
```
最常见的是验证码爆破
```
## ![](../img/github11.png)直接通读全文代码
首先需要看看有哪些文件和文件夹，寻找名称里有没有带有api、admin、manage、include 一类关键字的文件和文件夹，通常这些文件比较重要。一般核心文件都在include文件夹里
 addslashes()过滤掉了单引号、双引号、NULL 字符以及斜杠，只要参数在拼接到 SQL 语句前，除非有宽字节注入或者其他特殊情况，否则使用了这个函数就不能注入了。

__原创文章，转载请注明转载自[http://www.8pwn.com](http://www.8pwn.com)__

[返回上一层](./web)
